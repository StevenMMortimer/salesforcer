<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Working with Metadata • salesforcer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Working with Metadata">
<meta property="og:description" content="salesforcer">
<meta property="og:image" content="https://stevenmmortimer.github.io/salesforcer/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-98603021-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-98603021-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">salesforcer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting-started.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/supported-queries.html">Supported Queries</a>
    </li>
    <li>
      <a href="../articles/working-with-bulk-apis.html">Working with Bulk APIs</a>
    </li>
    <li>
      <a href="../articles/working-with-reports.html">Working with Reports</a>
    </li>
    <li>
      <a href="../articles/working-with-attachments.html">Working with Attachments</a>
    </li>
    <li>
      <a href="../articles/working-with-metadata.html">Working with Metadata</a>
    </li>
    <li>
      <a href="../articles/passing-control-args.html">Passing Control Args</a>
    </li>
    <li>
      <a href="../articles/transitioning-from-RForcecom.html">Transitioning from RForcecom</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/StevenMMortimer/salesforcer" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Working with Metadata</h1>
                        <h4 data-toc-skip class="author">Steven M. Mortimer</h4>
            
            <h4 data-toc-skip class="date">2019-07-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/StevenMMortimer/salesforcer/blob/HEAD/vignettes/working-with-metadata.Rmd" class="external-link"><code>vignettes/working-with-metadata.Rmd</code></a></small>
      <div class="hidden name"><code>working-with-metadata.Rmd</code></div>

    </div>

    
    
<p>Salesforce is a very flexible platform in that it provides the <a href="https://developer.salesforce.com/docs/atlas.en-us.api_meta.meta/api_meta/meta_intro.htm" class="external-link">Metadata API</a> for users to create, read, update and delete their entire Salesforce environment from objects to page layouts and more. This makes it very easy to programmatically setup and teardown the Salesforce environment.</p>
<div class="section level2">
<h2 id="retrieving-object-metadata">Retrieving Object Metadata<a class="anchor" aria-label="anchor" href="#retrieving-object-metadata"></a>
</h2>
<p>One common use case for the Metadata API is retrieving information about an object (fields, permissions, etc.). First, load the {salesforcer}, {dplyr}, and {purrr} packages and login, if needed.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org" class="external-link">purrr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/StevenMMortimer/salesforcer" class="external-link">salesforcer</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/sf_auth.html">sf_auth</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>You can use the <code><a href="../reference/sf_read_metadata.html">sf_read_metadata()</a></code> function to return a list of objects and their metadata. In the example below we retrieve the metadata for the Account and Contact objects. Note that the <code>metadata_type</code> argument is “CustomObject”. Standard Objects are an implementation of CustomObjects, so they are returned using that metadata type.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">read_obj_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sf_read_metadata.html">sf_read_metadata</a></span><span class="op">(</span>metadata_type <span class="op">=</span> <span class="st">"CustomObject"</span>,
                                    object_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Account"</span>, <span class="st">"Contact"</span><span class="op">)</span><span class="op">)</span>

<span class="va">read_obj_result</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fullName"</span>, <span class="st">"label"</span>, <span class="st">"sharingModel"</span>, <span class="st">"enableHistory"</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; $fullName</span>
<span class="co">#&gt; [1] "Account"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $label</span>
<span class="co">#&gt; [1] "Account"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sharingModel</span>
<span class="co">#&gt; [1] "ReadWrite"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $enableHistory</span>
<span class="co">#&gt; [1] "false"</span>

<span class="va">first_two_fields_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">read_obj_result</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">==</span> <span class="st">"fields"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>

<span class="co"># show the first two returned fields of the Account object</span>
<span class="va">read_obj_result</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">first_two_fields_idx</span><span class="op">]</span>
<span class="co">#&gt; $fields</span>
<span class="co">#&gt; $fields$fullName</span>
<span class="co">#&gt; [1] "AccountNumber"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fields$trackFeedHistory</span>
<span class="co">#&gt; [1] "false"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fields</span>
<span class="co">#&gt; $fields$fullName</span>
<span class="co">#&gt; [1] "AccountSource"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fields$trackFeedHistory</span>
<span class="co">#&gt; [1] "false"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fields$type</span>
<span class="co">#&gt; [1] "Picklist"</span></code></pre></div>
<p>The data is returned as a list because object definitions are highly nested representations. You may notice that we are missing some really specific details, such as, the picklist values of a field with type “Picklist”. You can get that information using<br><code><a href="../reference/sf_describe_object_fields.html">sf_describe_object_fields()</a></code>. Here is an example using <code><a href="../reference/sf_describe_object_fields.html">sf_describe_object_fields()</a></code> where we get a <code>tbl_df</code> with one row for each field on the Account object:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">acct_fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sf_describe_object_fields.html">sf_describe_object_fields</a></span><span class="op">(</span><span class="st">"Account"</span><span class="op">)</span>
<span class="va">acct_fields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">label</span>, <span class="va">length</span>, <span class="va">soapType</span>, <span class="va">type</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 68 × 5</span></span>
<span class="co">#&gt;   name           label            length soapType    type     </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Id             Account ID       18     tns:ID      id       </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> IsDeleted      Deleted          0      xsd:boolean boolean  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> MasterRecordId Master Record ID 18     tns:ID      reference</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Name           Account Name     255    xsd:string  string   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Type           Account Type     255    xsd:string  picklist </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 63 more rows</span></span>

<span class="co"># show the picklist selection options for the Account Type field</span>
<span class="va">acct_fields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">label</span> <span class="op">==</span> <span class="st">"Account Type"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="va">.</span><span class="op">$</span><span class="va">picklistValues</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 4</span></span>
<span class="co">#&gt;   active defaultValue label                      value                     </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> true   false        Prospect                   Prospect                  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> true   false        Customer - Direct          Customer - Direct         </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> true   false        Customer - Channel         Customer - Channel        </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> true   false        Channel Partner / Reseller Channel Partner / Reseller</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> true   false        Installation Partner       Installation Partner      </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 2 more rows</span></span></code></pre></div>
<p>If you prefer to be more precise about collecting and formatting the field data you can work directly with the nested lists that the APIs return. In this example we look at the picklist values of fields on the Account object.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">describe_obj_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sf_describe_objects.html">sf_describe_objects</a></span><span class="op">(</span>object_names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Account'</span>, <span class="st">'Contact'</span><span class="op">)</span><span class="op">)</span>

<span class="co"># confirm that the Account object is queryable</span>
<span class="va">describe_obj_result</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'label'</span>, <span class="st">'queryable'</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; $label</span>
<span class="co">#&gt; [1] "Account"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $queryable</span>
<span class="co">#&gt; [1] "true"</span>

<span class="co"># now show the different picklist values for the Account Type field</span>
<span class="va">all_fields</span> <span class="op">&lt;-</span> <span class="va">describe_obj_result</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">describe_obj_result</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">==</span> <span class="st">"fields"</span><span class="op">]</span>

<span class="va">acct_type_field_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">all_fields</span>, 
                                    FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">$</span><span class="va">label</span><span class="op">}</span><span class="op">)</span> <span class="op">==</span> <span class="st">"Account Type"</span><span class="op">)</span>
<span class="va">acct_type_field</span> <span class="op">&lt;-</span> <span class="va">all_fields</span><span class="op">[[</span><span class="va">acct_type_field_idx</span><span class="op">]</span><span class="op">]</span>
<span class="va">acct_type_field</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">acct_type_field</span><span class="op">)</span> <span class="op">==</span> <span class="st">"picklistValues"</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_df</a></span><span class="op">(</span><span class="va">as_tibble</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 4</span></span>
<span class="co">#&gt;   active defaultValue label                      value                     </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> true   false        Prospect                   Prospect                  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> true   false        Customer - Direct          Customer - Direct         </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> true   false        Customer - Channel         Customer - Channel        </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> true   false        Channel Partner / Reseller Channel Partner / Reseller</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> true   false        Installation Partner       Installation Partner      </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 2 more rows</span></span></code></pre></div>
<p>It is recommended that you try out the various metadata functions <code><a href="../reference/sf_read_metadata.html">sf_read_metadata()</a></code>, <code><a href="../reference/sf_list_metadata.html">sf_list_metadata()</a></code>, <code><a href="../reference/sf_describe_metadata.html">sf_describe_metadata()</a></code>, and <code><a href="../reference/sf_describe_objects.html">sf_describe_objects()</a></code> in order to see which information best suits your use case.</p>
</div>
<div class="section level2">
<h2 id="modifying-metadata">Modifying Metadata<a class="anchor" aria-label="anchor" href="#modifying-metadata"></a>
</h2>
<p>Where the Metadata API really shines is when it comes to CRUD operations on metadata. In this example we will create an object, add fields to it, then delete that object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create an object</span>
<span class="va">base_obj_name</span> <span class="op">&lt;-</span> <span class="st">"Custom_Account1"</span>
<span class="va">custom_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">custom_object</span><span class="op">$</span><span class="va">fullName</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">base_obj_name</span>, <span class="st">"__c"</span><span class="op">)</span>
<span class="va">custom_object</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"_"</span>, <span class="st">" "</span>, <span class="va">base_obj_name</span><span class="op">)</span><span class="op">)</span>
<span class="va">custom_object</span><span class="op">$</span><span class="va">pluralLabel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">base_obj_name</span>, <span class="st">"s"</span><span class="op">)</span>
<span class="va">custom_object</span><span class="op">$</span><span class="va">nameField</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>displayFormat <span class="op">=</span> <span class="st">'AN-{0000}'</span>, 
                                label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">base_obj_name</span>, <span class="st">' Number'</span><span class="op">)</span>, 
                                type <span class="op">=</span> <span class="st">'AutoNumber'</span><span class="op">)</span>
<span class="va">custom_object</span><span class="op">$</span><span class="va">deploymentStatus</span> <span class="op">&lt;-</span> <span class="st">'Deployed'</span>
<span class="va">custom_object</span><span class="op">$</span><span class="va">sharingModel</span> <span class="op">&lt;-</span> <span class="st">'ReadWrite'</span>
<span class="va">custom_object</span><span class="op">$</span><span class="va">enableActivities</span> <span class="op">&lt;-</span> <span class="st">'true'</span>
<span class="va">custom_object</span><span class="op">$</span><span class="va">description</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">base_obj_name</span>, <span class="st">" created by the Metadata API"</span><span class="op">)</span>
<span class="va">custom_object_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sf_create_metadata.html">sf_create_metadata</a></span><span class="op">(</span>metadata_type <span class="op">=</span> <span class="st">'CustomObject'</span>,
                                           metadata <span class="op">=</span> <span class="va">custom_object</span><span class="op">)</span>

<span class="co"># add fields to the object</span>
<span class="va">custom_fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>fullName<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">base_obj_name</span>, <span class="st">'__c.CustomField3__c'</span><span class="op">)</span>, 
                                   <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">base_obj_name</span>, <span class="st">'__c.CustomField4__c'</span><span class="op">)</span><span class="op">)</span>, 
                        label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Test Field3'</span>, <span class="st">'Test Field4'</span><span class="op">)</span>, 
                        length<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span>, 
                        type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Text'</span>, <span class="st">'Text'</span><span class="op">)</span><span class="op">)</span>
<span class="va">create_fields_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sf_create_metadata.html">sf_create_metadata</a></span><span class="op">(</span>metadata_type <span class="op">=</span> <span class="st">'CustomField'</span>, 
                                           metadata <span class="op">=</span> <span class="va">custom_fields</span><span class="op">)</span>

<span class="co"># delete the object</span>
<span class="va">delete_obj_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sf_delete_metadata.html">sf_delete_metadata</a></span><span class="op">(</span>metadata_type <span class="op">=</span> <span class="st">'CustomObject'</span>, 
                                        object_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Custom_Account1__c'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Note that newly created custom fields are not editable by default, meaning that you will not be able to insert records into them until updating the field level security of your user profile. Run the following code to determine the user profiles in your org and updating the field permissions on an object that you may have created with the example code above.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get list of user proviles in order to get the "fullName" </span>
<span class="co"># parameter correct in the next call</span>
<span class="va">my_queries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">'Profile'</span><span class="op">)</span><span class="op">)</span>
<span class="va">profiles_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sf_list_metadata.html">sf_list_metadata</a></span><span class="op">(</span>queries <span class="op">=</span> <span class="va">my_queries</span><span class="op">)</span>

<span class="va">admin_editable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fullName <span class="op">=</span> <span class="st">'Admin'</span>, 
                       fieldPermissions<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>field<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">custom_object</span><span class="op">$</span><span class="va">fullName</span>, 
                                                          <span class="st">'.CustomField3__c'</span><span class="op">)</span>,
                                             editable<span class="op">=</span><span class="st">'true'</span><span class="op">)</span>, 
                       fieldPermissions<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>field<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">custom_object</span><span class="op">$</span><span class="va">fullName</span>, 
                                                          <span class="st">'.CustomField4__c'</span><span class="op">)</span>,
                                             editable<span class="op">=</span><span class="st">'true'</span><span class="op">)</span><span class="op">)</span>

<span class="co"># update the field level security to "editable" for your fields</span>
<span class="va">prof_update</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sf_update_metadata.html">sf_update_metadata</a></span><span class="op">(</span>metadata_type <span class="op">=</span> <span class="st">'Profile'</span>, 
                                  metadata <span class="op">=</span> <span class="va">admin_editable</span><span class="op">)</span>

<span class="co"># now try inserting values into that custom object's fields</span>
<span class="va">my_new_data</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>CustomField3__c <span class="op">=</span> <span class="st">"Hello World"</span>, CustomField4__c <span class="op">=</span> <span class="st">"Hello World"</span><span class="op">)</span>
<span class="va">added_record</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sf_create.html">sf_create</a></span><span class="op">(</span><span class="va">my_new_data</span>, object_name <span class="op">=</span> <span class="va">custom_object</span><span class="op">$</span><span class="va">fullName</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Steven M. Mortimer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    appId: 'BBX5BTLUTL',
    
    apiKey: 'f3a7c81cd6794f9050f32bfee2620882',
    indexName: 'salesforcer',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
