<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get a report's data in tabular format — sf_run_report • salesforcer</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get a report's data in tabular format — sf_run_report"><meta name="description" content="
This function is a convenience wrapper for retrieving the data from a report.
By default, it executes an asynchronous report and waits for the detailed data
summarized in a tabular format, before pulling them down and returning as a
tbl_df."><meta property="og:description" content="
This function is a convenience wrapper for retrieving the data from a report.
By default, it executes an asynchronous report and waits for the detailed data
summarized in a tabular format, before pulling them down and returning as a
tbl_df."><meta property="og:image" content="https://stevenmmortimer.github.io/salesforcer/reference/figures/salesforcer.png"><meta property="og:image:alt" content="salesforcer package logo"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-98603021-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-98603021-2');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">salesforcer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/supported-queries.html">Supported Queries</a></li>
    <li><a class="dropdown-item" href="../articles/working-with-bulk-apis.html">Working with Bulk APIs</a></li>
    <li><a class="dropdown-item" href="../articles/working-with-reports.html">Working with Reports</a></li>
    <li><a class="dropdown-item" href="../articles/working-with-attachments.html">Working with Attachments</a></li>
    <li><a class="dropdown-item" href="../articles/working-with-metadata.html">Working with Metadata</a></li>
    <li><a class="dropdown-item" href="../articles/passing-control-args.html">Passing Control Args</a></li>
    <li><a class="dropdown-item" href="../articles/transitioning-from-RForcecom.html">Transitioning from RForcecom</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/StevenMMortimer/salesforcer"><span class="fa fa-github fa-lg"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get a report's data in tabular format</h1>
      <small class="dont-index">Source: <a href="https://github.com/StevenMMortimer/salesforcer/blob/main/R/analytics-report.R" class="external-link"><code>R/analytics-report.R</code></a></small>
      <div class="d-none name"><code>sf_run_report.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>This function is a convenience wrapper for retrieving the data from a report.
By default, it executes an asynchronous report and waits for the detailed data
summarized in a tabular format, before pulling them down and returning as a
<code>tbl_df</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sf_run_report</span><span class="op">(</span></span>
<span>  <span class="va">report_id</span>,</span>
<span>  report_filters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  report_boolean_logic <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sort_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>  decreasing <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  top_n <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  async <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  interval_seconds <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  max_attempts <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  wait_for_results <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  guess_types <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bind_using_character_cols <span class="op">=</span> <span class="fu">deprecated</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  fact_map_key <span class="op">=</span> <span class="st">"T!T"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-report-id">report_id<a class="anchor" aria-label="anchor" href="#arg-report-id"></a></dt>
<dd><p><code>character</code>; the Salesforce Id assigned to a created
analytics report. It will start with <code>"00O"</code>.</p></dd>


<dt id="arg-report-filters">report_filters<a class="anchor" aria-label="anchor" href="#arg-report-filters"></a></dt>
<dd><p><code>list</code>; A <code>list</code> of reportFilter specifications.
Each must be a list with 3 elements: 1) <code>column</code>, 2) <code>operator</code>, and
3) <code>value</code>. You can find out how certain field types can be filtered by
reviewing the results of <code><a href="sf_list_report_filter_operators.html">sf_list_report_filter_operators</a></code>.</p></dd>


<dt id="arg-report-boolean-logic">report_boolean_logic<a class="anchor" aria-label="anchor" href="#arg-report-boolean-logic"></a></dt>
<dd><p><code>character</code>; a string of boolean logic to parse
custom field filters if more than one is specified. For example, if three filters
are specified, then they can be combined using the logic <code>"(1 OR 2) AND 3"</code>.</p></dd>


<dt id="arg-sort-by">sort_by<a class="anchor" aria-label="anchor" href="#arg-sort-by"></a></dt>
<dd><p><code>character</code>; the name of the column(s) used to sort the results.</p></dd>


<dt id="arg-decreasing">decreasing<a class="anchor" aria-label="anchor" href="#arg-decreasing"></a></dt>
<dd><p><code>logical</code>; a indicator of whether the results should be
ordered by increasing or decreasing values in <code>sort_by</code> column when selecting the
top N records. Note, this argument will be ignored if not specifying Top N. You can
sort the records using <code><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></code> after the results are returned.</p></dd>


<dt id="arg-top-n">top_n<a class="anchor" aria-label="anchor" href="#arg-top-n"></a></dt>
<dd><p><code>integer</code>; an integer which sets a row limit filter to a report.
The results will be ordered as they appear in the report unless specified differently
via the <code>sort_by</code> and <code>decreasing</code> arguments. Note, it is sometimes
helpful to specify the <code>top_n</code> argument if a report contains many rows, but
you are only interested in a subset of them. Alternatively, you can limit the count
of returned rows via the <code>report_filters</code> argument.</p></dd>


<dt id="arg-async">async<a class="anchor" aria-label="anchor" href="#arg-async"></a></dt>
<dd><p><code>logical</code>; an indicator, by default set to <code>TRUE</code>, which
executes the report asynchronously. If executed asynchronously, this function
will return a list of attributes of the created report instance. The results
can be pulled down by providing the report id and instance id to
the function <code><a href="sf_get_report_instance_results.html">sf_get_report_instance_results</a></code>. Refer to the details
of the documentation on why executing a report asynchronously is preferred.</p></dd>


<dt id="arg-interval-seconds">interval_seconds<a class="anchor" aria-label="anchor" href="#arg-interval-seconds"></a></dt>
<dd><p><code>integer</code>; defines the seconds between attempts to check
for job completion.</p></dd>


<dt id="arg-max-attempts">max_attempts<a class="anchor" aria-label="anchor" href="#arg-max-attempts"></a></dt>
<dd><p><code>integer</code>; defines then max number attempts to check for job
completion before stopping.</p></dd>


<dt id="arg-wait-for-results">wait_for_results<a class="anchor" aria-label="anchor" href="#arg-wait-for-results"></a></dt>
<dd><p><code>logical</code>; indicating whether to wait for the
report finish running so that data can be obtained. Otherwise, return the
report instance details which can be used to retrieve the results when the
async report has finished.</p></dd>


<dt id="arg-guess-types">guess_types<a class="anchor" aria-label="anchor" href="#arg-guess-types"></a></dt>
<dd><p><code>logical</code>; indicating whether or not to use <code>col_guess()</code>
to try and cast the data returned in the recordset. If <code>TRUE</code> then
<code>col_guess()</code> is used along with <code>anytime()</code> and <code>anydate()</code>.
If <code>FALSE</code> then all fields will be returned as character. Specifying
<code>FALSE</code> helpful when guessing the column data type will result in NA
values and you would like to return the results as strings and then cast in
your script according to your unique specifications.</p></dd>


<dt id="arg-bind-using-character-cols">bind_using_character_cols<a class="anchor" aria-label="anchor" href="#arg-bind-using-character-cols"></a></dt>
<dd><p><code>logical</code>; an indicator of whether to
cast the data to all character columns to ensure that <code><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></code>
does not fail because two paginated recordsets have differing datatypes for the
same column. Set this to <code>TRUE</code> rarely, typically only when having this
set to <code>FALSE</code> returns an error or you want all columns in the data to be
character.</p></dd>


<dt id="arg-fact-map-key">fact_map_key<a class="anchor" aria-label="anchor" href="#arg-fact-map-key"></a></dt>
<dd><p><code>character</code>; string providing an index into each
section of a fact map, from which you can access summary and detailed data.
The pattern for the fact map keys varies by report format so it is important
to know what the <code>reportFormat</code> property of the target report is. See the
note below for more details.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><code>logical</code>; an indicator of whether to print additional
detail for each API call, which is useful for debugging. More specifically, when
set to <code>TRUE</code> the URL, header, and body will be printed for each request,
along with additional diagnostic information where available.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>tbl_df</code></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is essentially a wrapper around <code><a href="sf_execute_report.html">sf_execute_report</a></code>.
Please review or use that function and/or <code><a href="sf_query_report.html">sf_query_report</a></code> if you
want to have more control over how the report is run and what format should
be returned. In this case we've forced the <code>reportFormat="TABULAR"</code>
without total rows and given options to filter, and select the Top N as
function arguments rather than forcing the user to create an entire list of
<code>reportMetadata</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Below are the fact map key patterns for three report types:</p><dl><dt>TABULAR</dt>
<dd><p><code>T!T</code>: The grand total of a report. Both record data
values and the grand total are represented by this key.</p></dd>

<dt>SUMMARY</dt>
<dd><p><code>&lt;First level row grouping_second level row grouping_third
  level row grouping&gt;!T</code>: T refers to the row grand total.</p></dd>

<dt>MATRIX</dt>
<dd><p><code>&lt;First level row grouping_second level row grouping&gt;!&lt;First
  level column grouping_second level column grouping&gt;.</code></p></dd>


</dl><p>Each item in a row or column grouping is numbered starting with 0. Here are
some examples of fact map keys:</p>
<dl><dt>0!T</dt>
<dd><p>The first item in the first-level grouping.</p></dd>

<dt>1!T</dt>
<dd><p>The second item in the first-level grouping.</p></dd>

<dt>0_0!T</dt>
<dd><p>The first item in the first-level grouping and the first item
in the second-level grouping.</p></dd>

<dt>0_1!T</dt>
<dd><p>The first item in the first-level grouping and the second item
in the second-level grouping.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="salesforce-documentation">Salesforce Documentation<a class="anchor" aria-label="anchor" href="#salesforce-documentation"></a></h2>


<ul><li><p><a href="https://developer.salesforce.com/docs/atlas.en-us.api_analytics.meta/api_analytics/sforce_analytics_rest_api_getreportrundata.htm" class="external-link">Sync Documentation</a></p></li>
<li><p><a href="https://developer.salesforce.com/docs/atlas.en-us.api_analytics.meta/api_analytics/sforce_analytics_rest_api_get_reportdata.htm#example_sync_reportexecute" class="external-link">Sync Example</a></p></li>
<li><p><a href="https://developer.salesforce.com/docs/atlas.en-us.api_analytics.meta/api_analytics/sforce_analytics_rest_api_instances_summaryasync.htm" class="external-link">Async Documentation</a></p></li>
<li><p><a href="https://developer.salesforce.com/docs/atlas.en-us.api_analytics.meta/api_analytics/sforce_analytics_rest_api_get_reportdata.htm#example_report_async_instances" class="external-link">Async Example</a></p></li>
<li><p><a href="https://developer.salesforce.com/docs/atlas.en-us.api_analytics.meta/api_analytics/sforce_analytics_rest_api_filter_reportdata.htm#example_requestbody_execute_resource" class="external-link">Filtering Results</a></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Report functions:
<code><a href="sf_copy_report.html">sf_copy_report</a>()</code>,
<code><a href="sf_create_report.html">sf_create_report</a>()</code>,
<code><a href="sf_delete_report.html">sf_delete_report</a>()</code>,
<code><a href="sf_describe_report.html">sf_describe_report</a>()</code>,
<code><a href="sf_describe_report_type.html">sf_describe_report_type</a>()</code>,
<code><a href="sf_execute_report.html">sf_execute_report</a>()</code>,
<code><a href="sf_list_report_fields.html">sf_list_report_fields</a>()</code>,
<code><a href="sf_list_report_filter_operators.html">sf_list_report_filter_operators</a>()</code>,
<code><a href="sf_list_report_types.html">sf_list_report_types</a>()</code>,
<code><a href="sf_list_reports.html">sf_list_reports</a>()</code>,
<code><a href="sf_query_report.html">sf_query_report</a>()</code>,
<code><a href="sf_update_report.html">sf_update_report</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># find a report in your org and run it</span></span></span>
<span class="r-in"><span><span class="va">all_reports</span> <span class="op">&lt;-</span> <span class="fu"><a href="sf_query.html">sf_query</a></span><span class="op">(</span><span class="st">"SELECT Id, Name FROM Report"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">this_report_id</span> <span class="op">&lt;-</span> <span class="va">all_reports</span><span class="op">$</span><span class="va">Id</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">sf_run_report</span><span class="op">(</span><span class="va">this_report_id</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># apply your own filters to that same report</span></span></span>
<span class="r-in"><span><span class="co"># set up some filters, if needed</span></span></span>
<span class="r-in"><span><span class="co"># filter records that was created before this month</span></span></span>
<span class="r-in"><span><span class="va">filter1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>column <span class="op">=</span> <span class="st">"CREATED_DATE"</span>,</span></span>
<span class="r-in"><span>                operator <span class="op">=</span> <span class="st">"lessThan"</span>, </span></span>
<span class="r-in"><span>                value <span class="op">=</span> <span class="st">"THIS_MONTH"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># filter records where the account billing address city is not empty</span></span></span>
<span class="r-in"><span><span class="va">filter2</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>column <span class="op">=</span> <span class="st">"ACCOUNT.ADDRESS1_CITY"</span>,</span></span>
<span class="r-in"><span>                 operator <span class="op">=</span> <span class="st">"notEqual"</span>, </span></span>
<span class="r-in"><span>                 value <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># combine filter1 and filter2 using 'AND' so that records must meet both filters</span></span></span>
<span class="r-in"><span><span class="va">results_using_AND</span> <span class="op">&lt;-</span> <span class="fu">sf_run_report</span><span class="op">(</span><span class="va">my_report_id</span>, </span></span>
<span class="r-in"><span>                                   report_boolean_logic <span class="op">=</span> <span class="st">"1 AND 2"</span>,</span></span>
<span class="r-in"><span>                                   report_filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">filter1</span>, <span class="va">filter2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># combine filter1 and filter2 using 'OR' which means that records must meet one </span></span></span>
<span class="r-in"><span><span class="co"># of the filters but also throw in a row limit based on a specific sort order</span></span></span>
<span class="r-in"><span><span class="va">results_using_OR</span> <span class="op">&lt;-</span> <span class="fu">sf_run_report</span><span class="op">(</span><span class="va">my_report_id</span>, </span></span>
<span class="r-in"><span>                                  report_boolean_logic <span class="op">=</span> <span class="st">"1 OR 2"</span>,</span></span>
<span class="r-in"><span>                                  report_filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">filter1</span>, <span class="va">filter2</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                                  sort_by <span class="op">=</span> <span class="st">"Contact.test_number__c"</span>, </span></span>
<span class="r-in"><span>                                  decreasing <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>                                  top_n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Steven M. Mortimer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

