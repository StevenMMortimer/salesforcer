<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Working with Bulk APIs • salesforcer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Working with Bulk APIs">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-98603021-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-98603021-2');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">salesforcer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/supported-queries.html">Supported Queries</a></li>
    <li><a class="dropdown-item" href="../articles/working-with-bulk-apis.html">Working with Bulk APIs</a></li>
    <li><a class="dropdown-item" href="../articles/working-with-reports.html">Working with Reports</a></li>
    <li><a class="dropdown-item" href="../articles/working-with-attachments.html">Working with Attachments</a></li>
    <li><a class="dropdown-item" href="../articles/working-with-metadata.html">Working with Metadata</a></li>
    <li><a class="dropdown-item" href="../articles/passing-control-args.html">Passing Control Args</a></li>
    <li><a class="dropdown-item" href="../articles/transitioning-from-RForcecom.html">Transitioning from RForcecom</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/StevenMMortimer/salesforcer"><span class="fa fa-github fa-lg"></span> GitHub</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Working with Bulk APIs</h1>
                        <h4 data-toc-skip class="author">Steven M.
Mortimer</h4>
            
            <h4 data-toc-skip class="date">2020-07-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/StevenMMortimer/salesforcer/blob/main/vignettes/working-with-bulk-apis.Rmd" class="external-link"><code>vignettes/working-with-bulk-apis.Rmd</code></a></small>
      <div class="d-none name"><code>working-with-bulk-apis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="using-the-bulk-api">Using the Bulk API<a class="anchor" aria-label="anchor" href="#using-the-bulk-api"></a>
</h2>
<p>First, load the {salesforcer} and {dplyr} packages and login, if
needed.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/StevenMMortimer/salesforcer" class="external-link">salesforcer</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/sf_auth.html">sf_auth</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>For really large inserts, updates, deletes, upserts, and queries you
can just add <code>api_type = "Bulk 1.0"</code> to most functions to get
the benefits of using the Bulk API instead of the SOAP or REST APIs. The
change you have to make from using the REST API to the Bulk 1.0 API as
simple as adding <code>api_type="Bulk 1.0"</code> to your function
arguments. First, let’s build a <code>tbl_df</code> with two new records
to be created.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">prefix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Bulk-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">100000</span><span class="op">)</span><span class="op">)</span>, <span class="st">"-"</span><span class="op">)</span></span>
<span><span class="va">new_contacts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>FirstName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Test"</span>, <span class="va">n</span><span class="op">)</span>,</span>
<span>                       LastName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Contact-Create-"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span>,</span>
<span>                       My_External_Id__c<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">prefix</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>There are some differences in the way the REST API returns response
information vs.  the Bulk 1.0 API. However, the changes in Salesforce
are exactly the same for these two calls.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># REST</span></span>
<span><span class="va">rest_created_records</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sf_create.html">sf_create</a></span><span class="op">(</span><span class="va">new_contacts</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="op">]</span>, </span>
<span>                                  object_name<span class="op">=</span><span class="st">"Contact"</span>, </span>
<span>                                  api_type<span class="op">=</span><span class="st">"REST"</span><span class="op">)</span></span>
<span><span class="va">rest_created_records</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   success errors    </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> FALSE   <span style="color: #949494;">&lt;list [1]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> FALSE   <span style="color: #949494;">&lt;list [1]&gt;</span></span></span>
<span></span>
<span><span class="co"># Bulk</span></span>
<span><span class="va">bulk_created_records</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sf_create.html">sf_create</a></span><span class="op">(</span><span class="va">new_contacts</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>,<span class="op">]</span>, </span>
<span>                                  object_name<span class="op">=</span><span class="st">"Contact"</span>, </span>
<span>                                  api_type<span class="op">=</span><span class="st">"Bulk 1.0"</span><span class="op">)</span></span>
<span><span class="va">bulk_created_records</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   Id    Success Created Error                                                   </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #BB0000;">NA</span>    FALSE   FALSE   DUPLICATE_VALUE:duplicate value found: My_External_Id__…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> <span style="color: #BB0000;">NA</span>    FALSE   FALSE   DUPLICATE_VALUE:duplicate value found: My_External_Id__…</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-complete-bulk-api-workflow">A Complete Bulk API Workflow<a class="anchor" aria-label="anchor" href="#a-complete-bulk-api-workflow"></a>
</h2>
<p>To show a more lengthy example of using the Bulk 1.0 API, below is a
workflow of that creates 2 records, queries them, and deletes them. This
is just an example. Typically, you’d want to use the Bulk APIs over the
REST or SOAP APIs when dealing with over 10,000 records.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="st">"Contact"</span></span>
<span><span class="va">created_records</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sf_create.html">sf_create</a></span><span class="op">(</span><span class="va">new_contacts</span>, object_name<span class="op">=</span><span class="va">object</span>, api_type<span class="op">=</span><span class="st">"Bulk 1.0"</span><span class="op">)</span></span>
<span><span class="va">created_records</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   Id                 Success Created Error</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 003Kg000002AcoeIAC TRUE    TRUE    <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 003Kg000002AcofIAC TRUE    TRUE    <span style="color: #BB0000;">NA</span></span></span>
<span></span>
<span><span class="co"># query bulk</span></span>
<span><span class="va">my_soql</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"SELECT Id,</span></span>
<span><span class="st">                           FirstName, </span></span>
<span><span class="st">                           LastName</span></span>
<span><span class="st">                    FROM Contact </span></span>
<span><span class="st">                    WHERE Id in ('%s')"</span>, </span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">created_records</span><span class="op">$</span><span class="va">Id</span> , collapse<span class="op">=</span><span class="st">"','"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">queried_records</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sf_query.html">sf_query</a></span><span class="op">(</span><span class="va">my_soql</span>, object_name<span class="op">=</span><span class="va">object</span>, api_type<span class="op">=</span><span class="st">"Bulk 1.0"</span><span class="op">)</span></span>
<span><span class="va">queried_records</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   Id                 FirstName LastName        </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 003Kg000002AcoeIAC Test      Contact-Create-1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 003Kg000002AcofIAC Test      Contact-Create-2</span></span>
<span></span>
<span><span class="co"># delete bulk</span></span>
<span><span class="va">deleted_records</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sf_delete.html">sf_delete</a></span><span class="op">(</span><span class="va">queried_records</span><span class="op">$</span><span class="va">Id</span>, object_name<span class="op">=</span><span class="va">object</span>, api_type<span class="op">=</span><span class="st">"Bulk 1.0"</span><span class="op">)</span></span>
<span><span class="va">deleted_records</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   Id                 Success Created Error</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 003Kg000002AcoeIAC TRUE    FALSE   <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 003Kg000002AcofIAC TRUE    FALSE   <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="query-limitations">Query Limitations<a class="anchor" aria-label="anchor" href="#query-limitations"></a>
</h2>
<p>There is one limitation to Bulk queries is that it does not support
the following operations or structures of SOQL:</p>
<ul>
<li>COUNT</li>
<li>ROLLUP</li>
<li>SUM</li>
<li>GROUP BY CUBE</li>
<li>OFFSET</li>
<li>Nested SOQL queries</li>
<li>Relationship fields</li>
<li>Compound address fields</li>
<li>Compound geolocation fields</li>
</ul>
</div>
<div class="section level2">
<h2 id="using-the-bulk-2-0-api">Using the Bulk 2.0 API<a class="anchor" aria-label="anchor" href="#using-the-bulk-2-0-api"></a>
</h2>
<p>Salesforce has more recently introduced the Bulk 2.0 API which is
supposed to be faster and have a more consistent JSON/REST based API
than the Bulk 1.0 API. In some cases I have noticed that the ordering of
the result records will differ from the order of the input data because
the data is batched and processed asynchronously. by Salesforce instead
of R. However, The Bulk 2.0 API returns every single field that was
included in the call so if you have an identifying key your dataset,
then it should not be a problem to join on that key with your original
data to bring in the newly assigned Salesforce Id that is generated when
the record was created in Salesforce. However, I have find it just seems
wasteful to transfer all of the field information back after the query
and have not found a significant performance improvement between the
Bulk 1.0 and Bulk 2.0. Finally, note that the status field names
(“Success”, “Created”, “Error”) are different from the Bulk 2.0 API.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">prefix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Bulk-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">100000</span><span class="op">)</span><span class="op">)</span>, <span class="st">"-"</span><span class="op">)</span></span>
<span><span class="va">new_contacts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>FirstName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Test"</span>, <span class="va">n</span><span class="op">)</span>,</span>
<span>                       LastName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Contact-Create-"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span>,</span>
<span>                       test_number__c <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span>,</span>
<span>                       My_External_Id__c<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">prefix</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">created_records_v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sf_create.html">sf_create</a></span><span class="op">(</span><span class="va">new_contacts</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span>, </span>
<span>                                object_name <span class="op">=</span> <span class="st">"Contact"</span>, </span>
<span>                                api_type <span class="op">=</span> <span class="st">"Bulk 1.0"</span><span class="op">)</span></span>
<span><span class="va">created_records_v1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 4</span></span></span>
<span><span class="co">#&gt;   Id                 Success Created Error</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 003Kg000002AcojIAC TRUE    TRUE    <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 003Kg000002AcokIAC TRUE    TRUE    <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 003Kg000002AcolIAC TRUE    TRUE    <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 003Kg000002AcomIAC TRUE    TRUE    <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 003Kg000002AconIAC TRUE    TRUE    <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5 more rows</span></span></span>
<span></span>
<span><span class="va">created_records_v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sf_create.html">sf_create</a></span><span class="op">(</span><span class="va">new_contacts</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span>,</span>
<span>                                object_name <span class="op">=</span> <span class="st">"Contact"</span>, </span>
<span>                                api_type <span class="op">=</span> <span class="st">"Bulk 2.0"</span><span class="op">)</span></span>
<span><span class="va">created_records_v2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 7</span></span></span>
<span><span class="co">#&gt;   sf__Id             sf__Created sf__Error FirstName LastName  My_External_Id__c</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 003Kg000002AcotIAC TRUE        <span style="color: #BB0000;">NA</span>        Test      Contact-… Bulk-60076-k     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 003Kg000002AcouIAC TRUE        <span style="color: #BB0000;">NA</span>        Test      Contact-… Bulk-60076-l     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 003Kg000002AcovIAC TRUE        <span style="color: #BB0000;">NA</span>        Test      Contact-… Bulk-60076-m     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 003Kg000002AcowIAC TRUE        <span style="color: #BB0000;">NA</span>        Test      Contact-… Bulk-60076-n     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 003Kg000002AcoxIAC TRUE        <span style="color: #BB0000;">NA</span>        Test      Contact-… Bulk-60076-o     </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: test_number__c &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="performance-benchmarks-for-bulk-queries">Performance Benchmarks for Bulk Queries<a class="anchor" aria-label="anchor" href="#performance-benchmarks-for-bulk-queries"></a>
</h2>
<p>Below is a simple performance benchmark between the Bulk 1.0 and Bulk
2.0 APIs for a small query. In general, the Bulk 2.0 should be faster.
One potential reason for the implementation in R to be faster is that
the entire recordset is parsed at once from a downloaded CSV of the
results when using the Bulk 1.0 API. The Bulk 2.0 retrieves the same
data in large batches (typically 50,000 records at a time). I would
encourage users to experiment to see what works best in their Salesforce
Org.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">soql</span> <span class="op">&lt;-</span> <span class="st">"SELECT Id, Name FROM Contact"</span></span>
<span><span class="va">bulk1_query</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="../reference/sf_query.html">sf_query</a></span><span class="op">(</span><span class="va">soql</span>, <span class="st">"Contact"</span>, api_type<span class="op">=</span><span class="st">"Bulk 1.0"</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">bulk2_query</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="../reference/sf_query.html">sf_query</a></span><span class="op">(</span><span class="va">soql</span>, api_type<span class="op">=</span><span class="st">"Bulk 2.0"</span><span class="op">)</span><span class="op">}</span> <span class="co"># Bulk 2.0 doesn't need object name</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span></span>
<span>  <span class="fu">bulk1_query</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu">bulk2_query</span><span class="op">(</span><span class="op">)</span>, </span>
<span>  times<span class="op">=</span><span class="fl">8</span>, </span>
<span>  unit <span class="op">=</span> <span class="st">"s"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">res</span></span>
<span><span class="co">#&gt; Unit: seconds</span></span>
<span><span class="co">#&gt;           expr      min       lq     mean   median       uq      max neval</span></span>
<span><span class="co">#&gt;  bulk1_query() 7.297599 7.386400 7.660917 7.473656 7.645973 8.977676     8</span></span>
<span><span class="co">#&gt;  bulk2_query() 6.474612 6.565457 6.636415 6.634955 6.726244 6.763391     8</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Time [seconds]"</span>, n.breaks<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="working-with-bulk-apis_files/figure-html/unnamed-chunk-7-1.png" alt="A violin plot showing the distribution of latency times for Bulk API and Bulk 2.0 API" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Steven M. Mortimer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
